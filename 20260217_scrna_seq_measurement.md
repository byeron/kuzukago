## 遺伝子からタンパク質への翻訳
前提として、現在我々が計測できるのは `DNA`である。
`DNA`とは、`A`,`T`,`G`,`C`の塩基で構成される配列を示し、生体内では二重らせん構造を形成している。
二重らせんを単純化すると以下のようになる。
ここで互いに結合する塩基の対応は、
- `A -> T`
- `T -> A`
- `C -> G`
- `G -> C`
である。
```
(鎖a) TTCGTAG ...

(鎖b) AAGCATC ...
```
DNA は遺伝情報を持ち、その役割は遺伝情報に基づきタンパク質（アミノ酸配列）の合成である。
ただし、DNA からアミノ酸配列へ直接変換されるのではなく、RNA を経由する。

`RNA`は一言でいうと、DNA の塩基配列と相補的な塩基配列である。 
以下に DNA の塩基配列の一部が RNA と対応する例を示す。
ここで互いに結合する塩基の対応は、
- `A -> U`
- `T -> A`
- `C -> G`
- `G -> C`
である。
```
(鎖a) TACCTCCTGATT TACCTCCTGATT TACCTCCTGATT...

                   AUGGAGGACUAA (RNA)
```

DNA の塩基配列と相補的な塩基配列を構築することを `転写`と呼ぶ。
DNA は RNA の鋳型と表現されることがあり、プログラミングで言うところの `クラス定義`と`インスタンス`に対応する。
転写された RNA にはタンパク質の情報となる`エキソン`とタンパク質と関係しない`イントロン`の領域がある。
イントロンを取り除きエキソンのみにする振る舞いをスプライシングと呼び、スプライシングによって残ったタンパク質情報のみの RNA を `mRNA` メッセンジャーRNA と呼ぶ。

`mRNA`の配列は、細胞中に漂う様々な種類の`tRNA`と mRNAの配列の順序通りに結合する。
tRNA とは、アミノ酸情報を背負った短いRNAの配列で、mRNAによって順番通りに並び、並んだtRNAと対応するアミノ酸が順番に結合する。
このアミノ酸の合成を`翻訳`と呼ぶ。

## RNA に立ち返ると
RNA をまとめると、`計測することで特定のたんぱく質や生体機能の発現を直接的に知る`ための手がかりである。
そして、その機能を考えると DNA と比較して `非常に短命`であると考えられる。

## RNA を計測する
scRNA-seq とは、ある細胞について mRNA を計測することで、その細胞で起きているタンパク質合成を知る手法である。

## scRNA-seq の仕組み
こちらがビジュアル的にわかりやすい
- https://hu-bioinfo.github.io/docs/rna-seq/what-is-rna-seq/

ドライの研究者が最終的に欲しい情報は、遺伝子発現量のカウントマトリクスである。
その計測のために、大まかに以下のステップを行う

- RNA 抽出
  - 細胞から DNA やタンパク質を除いて純粋な RNA を抽出する
- `ライブラリ調製`
  - 抽出された RNA をシーケンサーで読み取れる形に加工する
    - mRNA を選択
    - mRNA を断片化（あるサイズで切断する）
    - mRNA -> cDNA への逆転写
      -  **短命な RNA を 安定な(c)DNAに変換することで延命**
    - アダプター配列の付加: フラグメント（mRNA の断片）一つ一つにアダプター配列（フラグメントを区別するための帽子）をつける
    - PCR増幅: 生の cDNA だと計測するには数が少ないため、フラグメントの数を化学的に増やして数えやすくする
      - 
- シーケンシング
  - 調製されたライブラリ（フラグメント群）を並べて計測装置で読み取り、`リード`に変換する
    - リード: フラグメントから得られた塩基配列データ
  - リード（短い配列）をリファレンスゲノム（長い参照用配列）内でテンプレートマッチングを行い、どの遺伝子が発現しているかをマッピングする

以上の手順で、mRNAを定量的なデータに変換する。

## ライブラリ調製における工夫
フラグメント（cDNA）にはいくつかのヘッダーとフッターが取り付けられる。
PCR増幅前の一本のRNAフラグメントは、以下のようになっている。

`[細胞バーコード]-[UMI]-[cDNA]-[アダプター]`が取り付けられている。

- 細胞バーコード: どの細胞に由来するかを識別するための細胞ごとにユニークなid
- UMI: どのRNAフラグメントかを識別するために付与されるid
  - PCR増幅によってコピーフラグメントを大量に作成し、計測されやすくする
  - 計測後に UMI でユニーク化すると、PCRによる増幅のばらつきによらずRNAフラグメント1本をカウントできる
- cDNA: 計測対象本体
- アダプター

## まとめ
- scRNA-seq は mRNA より遺伝子発現を計測している
- 微弱な信号を捉えるための工夫がライブラリ調製で行われている
- ライブラリ調製の詳細を知ることで、正しいRNAの本数をカウントすることができる
- 仕組みを知ることで、正しいツール選択を行うことができる

